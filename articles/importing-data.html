<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="smartabaseR">
<title>Importing Data • smartabaseR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Importing Data">
<meta property="og:description" content="smartabaseR">
<meta property="og:image" content="https://teamworksapp.github.io/smartabaseR/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@zac_pross">
<meta name="twitter:site" content="@zac_pross">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">smartabaseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/get-started.html">Get Started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/credentials.html">Credential management</a>
    <a class="dropdown-item" href="../articles/exporting-data.html">Exporting data</a>
    <a class="dropdown-item" href="../articles/synchronising-with-smartabase.html">Synchronsing with Smartabase</a>
    <a class="dropdown-item" href="../articles/importing-data.html">Importing data</a>
    <a class="dropdown-item" href="../articles/deleting-data.html">Deleting data</a>
    <a class="dropdown-item" href="../articles/helper-functions.html">Helper functions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Teamworksapp/smartabaseR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Importing Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Teamworksapp/smartabaseR/blob/HEAD/vignettes/importing-data.Rmd" class="external-link"><code>vignettes/importing-data.Rmd</code></a></small>
      <div class="d-none name"><code>importing-data.Rmd</code></div>
    </div>

    
    
<p>If you haven’t already, please read the
<code><a href="../articles/get-started.html">vignette("get-started")</a></code> and
<code><a href="../articles/exporting-data.html">vignette("exporting-data")</a></code> vignettes before proceeding.</p>
<div class="section level2">
<h2 id="import-functions">Import functions<a class="anchor" aria-label="anchor" href="#import-functions"></a>
</h2>
<p><code>smartabaseR</code> provides four general functions for
importing data into Smartabase: <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>,
<code><a href="../reference/sb_update_event.html">sb_update_event()</a></code>, <code><a href="../reference/sb_upsert_event.html">sb_upsert_event()</a></code> and
<code><a href="../reference/sb_upsert_profile.html">sb_upsert_profile()</a></code>.</p>
<div class="section level3">
<h3 id="sb_insert_event">sb_insert_event()<a class="anchor" aria-label="anchor" href="#sb_insert_event"></a>
</h3>
<p>‘Inserting’ data into Smartabase means you are creating new events;
i.e. inserting new rows into the Smartabase event database.
<code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code> is the most commonly used import function
and ensures no chance of existing events being updated/overwritten.</p>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="st">"13/01/2023"</span>,</span>
<span>  user_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37204</span>, <span class="fl">37201</span><span class="op">)</span>,</span>
<span>  about <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Aiden Thomas"</span>, <span class="st">"Jamie Anderson"</span><span class="op">)</span>,</span>
<span>  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2530</span>, <span class="fl">5411</span><span class="op">)</span>,</span>
<span>  rpe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  entered_by_user_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37204</span>, <span class="fl">37201</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   start_date user_id about          distance   rpe entered_by_user_id</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 13/01/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas       <span style="text-decoration: underline;">2</span>530     5              <span style="text-decoration: underline;">37</span>204</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 13/01/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson     <span style="text-decoration: underline;">5</span>411     7              <span style="text-decoration: underline;">37</span>201</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_insert_event.html">sb_insert_event</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">training_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Team Summary"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> SUCCESSFULLY_INSERTED: 2 out of 2 records successfully inserted into Team Summary.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sb_update_event">sb_update_event()<a class="anchor" aria-label="anchor" href="#sb_update_event"></a>
</h3>
<p>‘Updating’ data in Smartabase means you are editing existing events
in the Smartabase event database. <code><a href="../reference/sb_update_event.html">sb_update_event()</a></code>
requires a valid <code>event_id</code> column in the supplied data
frame. These are Smartabase-generated unique IDs that ensure only the
correct events are updated/overwritten.</p>
<div class="section level4">
<h4 id="updating-is-the-same-as-overwriting">Updating is the same as overwriting<a class="anchor" aria-label="anchor" href="#updating-is-the-same-as-overwriting"></a>
</h4>
<p>Important side note: we chose the term ‘update’ for
<code><a href="../reference/sb_update_event.html">sb_update_event()</a></code> because it aligns with standard database
terminology, but arguably a more appropriate name would be
<code>sb_overwrite_event()</code>.</p>
<p>That’s because every event in the data frame supplied to
<code><a href="../reference/sb_update_event.html">sb_update_event()</a></code> completely overwrites the existing event
in the Smartabase event database.</p>
<p>Practically this also means that most calls to
<code><a href="../reference/sb_update_event.html">sb_update_event()</a></code> should be preceded by a call to
<code><a href="../reference/sb_get_event.html">sb_get_event()</a></code>/<code><a href="../reference/sb_sync_event.html">sb_sync_event()</a></code>. The latter
return a data frame that contain the entire Smartabase form, including
every column/field that contains data; not to mention the necessary
<code>event_id</code> column.</p>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>The workflow below involves exporting event data from Smartabase via
<code><a href="../reference/sb_get_event.html">sb_get_event()</a></code>, applying some transformation and then
importing the results using <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sb_get_event.html">sb_get_event</a></span><span class="op">(</span></span>
<span>  form <span class="op">=</span> <span class="st">"Training Log"</span>,</span>
<span>  date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"15/04/2023"</span>, <span class="st">"15/04/2023"</span><span class="op">)</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE Team Average Distanc…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>530     5 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>411     7 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Team Average Distance`</span></span></span></code></pre>
<p>We have two records. Their event IDs are <code>2381840</code> and
<code>238203</code>.</p>
<p>Notice that the field <code>Team Average Distance</code> is currently
empty. Let’s imagine we want to populate that field with the team’s
average distance without creating new records. First, let’s do the
calculation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">avg_dist_data</span> <span class="op">&lt;-</span> <span class="va">training_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="st">"Team Average Distance"</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Distance</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">avg_dist_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE Team Average Distanc…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>530     5                   <span style="text-decoration: underline;">3</span>970</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>411     7                   <span style="text-decoration: underline;">3</span>970</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Team Average Distance`</span></span></span></code></pre></div>
<p>All we need to do now is import our <code>avg_dist_data</code> data
back into our <code>Training Log</code> form via
<code><a href="../reference/sb_update_event.html">sb_update_event()</a></code> and the
<code>Team Average Distance</code> field will be populated:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_update_event.html">sb_update_event</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">avg_dist_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Training Log"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Running the above code will create a screen prompt that you will have
to interact with:</p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">WARNING</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You are about to UPDATE 2 records in Training Log.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please be aware the incoming data will overwrite the existing data.</span></span>
<span><span class="co">#&gt; The Smartabase API will be called once.</span></span>
<span><span class="co">#&gt; → Are you sure you want to continue?</span></span>
<span><span class="co">#&gt; 1: Yes</span></span>
<span><span class="co">#&gt; 2: No</span></span></code></pre>
<p>If you input “1” or “Yes” into the console then you’ll see:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> SUCCESSFULLY_UPDATED: 2 out of 2 records successfully updated in Training Log.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sb_upsert_event">sb_upsert_event()<a class="anchor" aria-label="anchor" href="#sb_upsert_event"></a>
</h3>
<p><a href="https://en.wiktionary.org/wiki/upsert" class="external-link">‘Upserting’</a> data
into Smartabase means events can either be created or updated, depending
on the <code>event_id</code> column. Rows with valid event IDs will
update the matching rows in the Smartabase event database, whereas rows
with no <code>event_id</code> will be inserted as new rows in the
Smartabase event database.</p>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>In this example we’ll get some training data from Smartabase using
<code><a href="../reference/sb_get_event.html">sb_get_event()</a></code>. We’ll then round down the
<code>Distance</code> values to the nearest 100 and add two more rows
where <code>Distance = 3000</code>.</p>
<p>To illustrate how <code><a href="../reference/sb_upsert_event.html">sb_upsert_event()</a></code> works, let’s first
get some event data from Smartabase:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sb_get_event.html">sb_get_event</a></span><span class="op">(</span></span>
<span>  form <span class="op">=</span> <span class="st">"Training Log"</span>,</span>
<span>  date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"15/04/2023"</span>, <span class="st">"15/04/2023"</span><span class="op">)</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>530     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>411     7</span></span></code></pre>
<p>Let’s say that we want to update this data in Smartabase such that
the <code>Distance</code> field is rounded down to the nearest 100:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> <span class="va">training_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">Distance</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.</span>, digits <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>500     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>400     7</span></span></code></pre></div>
<p>Imagine then we had some new <code>Training Log</code> data to insert
into Smartabase. Here’s the new data:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   start_date user_id Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 16/04/2023   <span style="text-decoration: underline;">37</span>207     <span style="text-decoration: underline;">3</span>000     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 16/04/2023   <span style="text-decoration: underline;">37</span>207     <span style="text-decoration: underline;">3</span>000     4</span></span></code></pre>
<p>Joining the data exported from Smartabase with this new data
gives:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upsert_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">training_data</span>, <span class="va">extra_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(start_date, user_id, Distance, RPE)`</span></span>
<span></span>
<span><span class="va">upsert_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>500     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>400     7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>           16/04/2023   <span style="text-decoration: underline;">37</span>207       <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">3</span>000     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>           16/04/2023   <span style="text-decoration: underline;">37</span>207       <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">3</span>000     4</span></span></code></pre></div>
<p>Note how the new data for athlete <code>37207</code> does not contain
event IDs. This will mean that supplying the <code>upsert_data</code>
frame to <code><a href="../reference/sb_upsert_event.html">sb_upsert_event()</a></code> will invoke two API calls: one
to insert the rows where <code>event_id = NA</code> and another to
update the remaining events:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_upsert_event.html">sb_upsert_event</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">upsert_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Training Log"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">WARNING</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You are about to UPDATE 2 records in Training Log.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please be aware the incoming data will overwrite the existing data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You will also INSERT 2 new records.</span></span>
<span><span class="co">#&gt; The Smartabase API will be called twice.</span></span>
<span><span class="co">#&gt; → Are you sure you want to continue?</span></span>
<span><span class="co">#&gt; 1: Yes</span></span>
<span><span class="co">#&gt; 2: No</span></span></code></pre>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 1: SUCCESSFULLY_UPDATED: 2 out of 2 records successfully updated in Training Log.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 2: SUCCESSFULLY_INSERTED: 2 out of 2 records successfully inserted into updated in Training Log.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sb_upsert_profile">sb_upsert_profile()<a class="anchor" aria-label="anchor" href="#sb_upsert_profile"></a>
</h3>
<p><code><a href="../reference/sb_upsert_profile.html">sb_upsert_profile()</a></code> is the only function for importing
profile data into Smartabase. Profile forms can only store one record
per athlete and therefore every import into a profile form is an upsert.
That is, for each athlete, the first time data is imported into a
profile form it will be an insert, but future profile imports will all
be updates.</p>
<div class="section level4">
<h4 id="example-3">Example<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_profile_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="st">"13/01/2023"</span>,</span>
<span>  user_id <span class="op">=</span> <span class="fl">37204</span>,</span>
<span>  about <span class="op">=</span> <span class="st">"Aiden Thomas"</span>,</span>
<span>  Team <span class="op">=</span> <span class="st">"First Team"</span>,</span>
<span>  entered_by_user_id <span class="op">=</span> <span class="fl">37204</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   form         start_date user_id event_id Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>204  2<span style="text-decoration: underline;">381</span>840     <span style="text-decoration: underline;">2</span>500     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Training Log 15/04/2023   <span style="text-decoration: underline;">37</span>201  2<span style="text-decoration: underline;">382</span>033     <span style="text-decoration: underline;">5</span>400     7</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_upsert_profile.html">sb_upsert_profile</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">example_profile_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Example Profile Form"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> SUCCESSFULLY_INSERTED: 1 out of 1 records successfully inserted into Example Profile Form.</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="option">
<code>option</code><a class="anchor" aria-label="anchor" href="#option"></a>
</h2>
<p>All <code>option</code> values must be generated by the relevant
helper function. So if we’re using <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code> and we
want to set <code>table_field = "Example Table Field"</code>, we would
set <code>table_field = "Example Table Field"</code> within
<code><a href="../reference/sb_get_event_option.html">sb_get_event_option()</a></code>. For example:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_get_event.html">sb_get_event</a></span><span class="op">(</span></span>
<span>  form <span class="op">=</span> <span class="st">"Example Form"</span>,</span>
<span>  date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"01/03/2023"</span>, <span class="st">"07/03/2023"</span><span class="op">)</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="../reference/sb_insert_event_option.html">sb_insert_event_option</a></span><span class="op">(</span></span>
<span>    table_field <span class="op">=</span> <span class="st">"Example Table Field"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Each import function has an associated option function:</p>
<ul>
<li><code>sb_update_event(..., option = sb_update_event_option())</code></li>
<li><code>sb_upsert_event..., option = sb_upsert_event_option())</code></li>
<li><code>sb_upsert_profile(..., option = sb_upsert_profile_option())</code></li>
<li>etc…</li>
</ul>
<p>Below goes into more detail about each available option.</p>
<p>Note: even though the below examples reference
<code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>, the same advice can be applied to the
other import functions: <code><a href="../reference/sb_update_event.html">sb_update_event()</a></code>,
<code><a href="../reference/sb_upsert_event.html">sb_upsert_event()</a></code> or <code><a href="../reference/sb_upsert_profile.html">sb_upsert_profile()</a></code>.</p>
<div class="section level3">
<h3 id="cache">
<code>cache</code><a class="anchor" aria-label="anchor" href="#cache"></a>
</h3>
<p>The first time you hit the Smartabase API within a given R session
(the first time you call <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>, for instance),
<code>smartabaseR</code> in the background first calls
<code><a href="../reference/sb_login.html">sb_login()</a></code>. If the <code>cache</code> option is set to
<code>TRUE</code> (default), then this login object is then saved into
memory and passed to further calls to the Smartabase API. If the
<code>cache</code> option is <code>FALSE</code>, then subsequent calls
to the Smartabase API will be preceded by a call to
<code><a href="../reference/sb_login.html">sb_login()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="id_col">
<code>id_col</code><a class="anchor" aria-label="anchor" href="#id_col"></a>
</h3>
<p>Whenever you import data into Smartabase, the API requires that there
exists a column called <code>user_id</code> in the data frame. This
represents each athlete’s Smartabase-generated user ID. The
<code>id_col</code> defaults to <code>"user_id"</code> for this
reason.</p>
<p>However, there may be situations where you don’t have the relevant
Smartabase user IDs handy. There are two approaches here: firstly, you
could make a call to sb_get_user() to get the user IDs yourself, then
join that to the event data by “user_id”; or, secondly, if your data
frame contains some other kind of identifying column like “username”,
“email” or “about” (that is, full name), then you can simply set the
<code>id_col</code> argument to the name of the identifying column. For
instance, <code>id_col = "about"</code>.</p>
<p><code>id_col</code> can either be set to “username”, “email” or
“about”.</p>
<div class="section level4">
<h4 id="example-4">Example<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<p>Below is a data frame we want to insert into the “Training Log” form
using <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   start_date about          Distance   RPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023 Aiden Thomas       <span style="text-decoration: underline;">2</span>530     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15/04/2023 Jamie Anderson     <span style="text-decoration: underline;">5</span>411     7</span></span></code></pre>
<p>Note how there is no <code>user_id</code> column, but there is an
<code>about</code> column. Our call to <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>
would then set
<code>option = sb_insert_event_option(id_col = "about")</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_insert_event.html">sb_insert_event</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">training_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Training Log"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="../reference/sb_insert_event_option.html">sb_insert_event_option</a></span><span class="op">(</span></span>
<span>    id_col <span class="op">=</span> <span class="st">"about"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Remember</strong>: <code>id_col</code> can only be set to
either “user_id”, “about”, “username” or “email”.</p>
</div>
</div>
<div class="section level3">
<h3 id="table_field">
<code>table_field</code><a class="anchor" aria-label="anchor" href="#table_field"></a>
</h3>
<p>Smartabase tables are used when you want to store multiple rows of
data in one event. For example, they are prevalent in strength testing
forms where an athlete is performing multiple exercises in the same
session.</p>
<div class="section level4">
<h4 id="example-5">Example<a class="anchor" aria-label="anchor" href="#example-5"></a>
</h4>
<p>Here is some event data from a form that contains both table and
non-table fields:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strength_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sb_get_event.html">sb_get_event</a></span><span class="op">(</span></span>
<span>  form <span class="op">=</span> <span class="st">"Strength Testing"</span>,</span>
<span>  date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"15/04/2023"</span>, end_date <span class="op">=</span> <span class="st">"15/04/2023"</span><span class="op">)</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="../reference/sb_get_event_option.html">sb_get_event_option</a></span><span class="op">(</span></span>
<span>    user_key <span class="op">=</span> <span class="st">"about"</span>,</span>
<span>    user_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Aiden Thomas"</span>, <span class="st">"Jamie Anderson"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strength_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   start_date user_id about      `Session RPE` Exercise  Load Repetition event_id</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Tho…             7 Bench P…   120          3  2<span style="text-decoration: underline;">381</span>840</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Tho…            <span style="color: #BB0000;">NA</span> Bench P…   115          3  2<span style="text-decoration: underline;">381</span>840</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Tho…            <span style="color: #BB0000;">NA</span> Bench P…   110          3  2<span style="text-decoration: underline;">381</span>840</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie And…             8 Back Sq…   170          3  2<span style="text-decoration: underline;">382</span>033</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie And…            <span style="color: #BB0000;">NA</span> Back Sq…   165          3  2<span style="text-decoration: underline;">382</span>033</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie And…            <span style="color: #BB0000;">NA</span> Back Sq…   185          3  2<span style="text-decoration: underline;">382</span>033</span></span></code></pre></div>
<p>Here <code>Exercise</code>, <code>Load</code> and
<code>Repetition</code> are all table fields, whereas
<code>Session RPE</code> is not – it was only recorded once in the
session. <code>start_date</code>, <code>user_id</code>,
<code>about</code> and <code>event_id</code> are metadata that will
always populate each row. You will notice that for each unique
start_date and user_id pairing, the non-table field
(<code>Session RPE</code>) will only populate the first row.</p>
<p>This structure is required whenever importing into forms with both
table and non-table fields. That is why the user must specify which
columns map to Smartabase table fields via <code>table_field</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sb_insert_event.html">sb_insert_event</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">strength_data</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"Strength Testing"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"example.smartabase.com/site"</span>,</span>
<span>  username <span class="op">=</span> <span class="st">"example.username"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"example_password"</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="../reference/sb_insert_event_option.html">sb_insert_event_option</a></span><span class="op">(</span></span>
<span>    table_field <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exercise"</span>, <span class="st">"Load"</span>, <span class="st">"Repetition"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code>table_field</code> takes a vector of column names.</p>
</div>
<div class="section level4">
<h4 id="duplicate-user_idstart_date-when-table_field-null">Duplicate user_id/start_date when
<code>table_field = NULL</code><a class="anchor" aria-label="anchor" href="#duplicate-user_idstart_date-when-table_field-null"></a>
</h4>
<p>If <code>table_field = NULL</code> but duplicate
<code>user_id</code>/<code>start_date</code> pairings are detected, the
data set will be split into a list of data frames. Each element of the
list, i.e., each data frame, contains a set of the original data whereby
there are no duplicate <code>user_id</code>/<code>start_date</code>
values internally. Each data set in the list is then imported via
individual API calls.</p>
<p>For example, let’s say we have the following data set</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">strength_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   start_date user_id about          exercise     load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat    170</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat    165</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat    165</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   115</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 16/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   110</span></span></code></pre></div>
<p>As you can see, Aiden Thomas has two records occurring on
“15/04/2023” while Jamie Anderson has three records occurring on the
“15/04/2023”. If we try to import this data while
<code>table_field</code> is left empty, <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code>
will internally split the data like this</p>
<pre><code><span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   start_date user_id about          exercise     load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat    170</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 16/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   110</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   start_date user_id about          exercise     load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat    165</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15/04/2023   <span style="text-decoration: underline;">37</span>204 Aiden Thomas   Bench Press   115</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`3`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   start_date user_id about          exercise    load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15/04/2023   <span style="text-decoration: underline;">37</span>201 Jamie Anderson Back Squat   165</span></span></code></pre>
<p>The first data set contains the first unique
<code>user_id</code>/<code>start_date</code> pairing; the second data
set contains the second unique
<code>user_id</code>/<code>start_date</code> pairing, and so on.</p>
</div>
</div>
<div class="section level3">
<h3 id="interactive_mode">
<code>interactive_mode</code><a class="anchor" aria-label="anchor" href="#interactive_mode"></a>
</h3>
<p><code>interactive_mode = FALSE</code> suppresses progress messages
that are intended for human end-users. Set
<code>interactive_mode = FALSE</code> when running
<code>smartabaseR</code> within automated pipelines.</p>
</div>
</div>
<div class="section level2">
<h2 id="miscellaneous">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous"></a>
</h2>
<div class="section level3">
<h3 id="start_date-end_date-start_time-end_time-columns">start_date / end_date / start_time / end_time columns<a class="anchor" aria-label="anchor" href="#start_date-end_date-start_time-end_time-columns"></a>
</h3>
<p>When uploading data to Smartabase, the API requires metadata about
when the event started and stopped. <code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code> will
first search for any columns in the data named “start_time” and
“end_time”. <strong>Note: start_time and end_time values must be in h:mm
AM or h:mm PM format.</strong> If those columns do not exist,
<code>start_time</code> and <code>end_time</code> will be set to the
current time and one hour after the current time, respectively.</p>
<p>Likewise,<code><a href="../reference/sb_insert_event.html">sb_insert_event()</a></code> will also search for any
columns named “start_date” or “end_date”, which <strong>must have values
formatted as dd/mm/YYYY</strong>. If those columns do not exist, both
<code>start_date</code> and <code>end_date</code> will be set to the
current date (unless the difference between <code>start_time</code> and
<code>end_time</code> spans midnight, in which case the
<code>end_date</code> will be set to the current date plus one day).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://au.linkedin.com/in/zac-pross" class="external-link">Zac Pross</a>, <a href="https://au.linkedin.com/in/james-day-ab648321" class="external-link">James Day</a>, Teamworks.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
